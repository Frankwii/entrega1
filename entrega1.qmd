---
title: "Entrega 1"
format: html
editor: source
author: 
  - Maria del Mar Deyà Torrens
  - Toni Fuentes Bauzá
  - Frank William Hammond Espinosa
toc: TRUE
lang: es
warning: FALSE
---

Instalamos los paquetes que vamos a necesitar:

```{r, eval=FALSE}
install.packages("palmerpenguins")
install.packages("ggplot2")
install.packages("stat_binhex")
install.packages("corrplot")
install.packages("tidyr")
```
```{r}
library(palmerpenguins)
library(ggplot2)
#library(stat_binhex)
library(corrplot)
library(tidyr)
```


## Exploración inicial y descripción de variables.

En primer lugar, visualizaremos el conjunto de datos.

```{r}
library(palmerpenguins)
str(penguins)
nrows=nrow(penguins)
```

Vemos que hay 344 observaciones de 8 variables:

### Especie

Esta variable es cualitativa nominal politómica.

Hemos visto ya en la descripción del tibble que hay tres especies de pingüino. Para ver qué especies son y cuántos ejemplares hay de cada una, utilizamos el siguiente codigo.

```{r}
x=table(penguins$species)
c(x,"NA's"=sum(is.na(penguins$species)))
```
Por tanto, de más a menos común, hay pingüinos de las especies *Adelie*, *Gentoo* y *Chinstrap*.

###  Isla

Esta variable es cualitativa nominal politómica.

```{r}
x=table(penguins$island)
c(x,"NA's"=sum(is.na(penguins$islands)))
```
De más a menos cantidad, hay pingüinos en las islas *Biscoe*, *Dream* y *Torgersen*.


###   Longitud del pico

Es cuantitativa continua, está expresada en milímetros y discretizada a las décimas ($10^{-4}$ metros).

Veamos los estadísticos estándares de esta variable:
```{r, echo=FALSE}
estadisticos=summary(penguins$bill_length_mm)
estadisticos
```

El pico más corto mide `r estadisticos[1]` milímetros, y el más largo, `r estadisticos[6]`. El primer cuartil de esta variable es `r estadisticos[2]`, la mediana `r estadisticos[3]` y el tercero `r estadisticos[5]`. La media es de `r estadisticos[4]` y la desviación típica muestral de `r sd(penguins$bill_length_mm)`. Además, hay `r estadisticos[7]` valores NA.

###   Profundidad del pico

Es cuantitativa continua, está expresada en milímetros y discretizada a las décimas ($10^{-4}$ metros).

```{r, echo=FALSE}
estadisticos=summary(penguins$bill_depth_mm)
estadisticos
```

El pico más fino mide `r estadisticos[1]` milímetros, y el más grueso, `r estadisticos[6]`. El primer cuartil de esta variable es `r estadisticos[2]`, la mediana `r estadisticos[3]` y el tercero `r estadisticos[5]`. La media es de `r estadisticos[4]` y la desviación típica muestral de `r sd(penguins$bill_length_mm)`. Además, hay `r estadisticos[7]` valores NA.

###   Longitud de la aleta

Es cuantitativa continua, está expresada en milímetros y discretizada a las unidades ($10^{-3}$ metros).

Veamos los estadísticos estándares de esta variable:
```{r, echo=FALSE}
estadisticos=summary(penguins$flipper_length_mm)
estadisticos
```

La aleta más corta mide `r estadisticos[1]` milímetros, y la más larga, `r estadisticos[6]`. El primer cuartil de esta variable es `r estadisticos[2]`, la mediana `r estadisticos[3]` y el tercero `r estadisticos[5]`. La media es de `r estadisticos[4]` y la desviación típica muestral de `r sd(penguins$bill_length_mm)`. Además, hay `r estadisticos[7]` valores NA.


###   Peso

Es cuantitativa continua, está expresada en gramos y discretizada a los múltiplos de 5 gramos. Para ver que, efectivamente, esa es la discretización, hemos utilizado el siguiente código:

```{r, echo=TRUE}
pesos=na.omit(penguins$body_mass_g)
sum(pesos%%5)
```

Deducimos que no hay ningún dato que no sea múltiplo de 5 (si hubiese alguno, la suma sería $>0$).

Veamos los estadísticos estándares de esta variable:

```{r, echo=FALSE}
estadisticos=summary(penguins$body_mass_g)
estadisticos
```

El pingüino más liviano pesa `r estadisticos[1]` gramos, y el más pesado, `r estadisticos[6]`. El primer cuartil de esta variable es `r estadisticos[2]`, la mediana `r estadisticos[3]` y el tercero `r estadisticos[5]`. La media es de `r estadisticos[4]` y la desviación típica muestral de `r sd(penguins$bill_length_mm)`. Además, hay `r estadisticos[7]` valores NA.


###   Sexo

Esta variable es cualitativa nominal dicotómica.

```{r}
x=table(penguins$sex)
c(x,"NA's"=sum(is.na(penguins$sex)))
```

###   Año

Esta variable es ordinal, pero R asigna a esta variable el tipo `int`, pues sus valores son números enteros. En realidad se trata de un factor ordenado. Podemos arreglar esto con el siguiente código:

```{r}
penguins$year=factor(penguins$year, ordered=TRUE)
penguins %>% str
```
Ahora sí tiene el tipo adecuado.

```{r}
x=table(penguins$year)
c(x,"NA's"=sum(is.na(penguins$year)))
```

La unidad muestral de la tabla es un pingüino.

```{r}
library(ggplot2)
species_colors = c("orange", "purple", "darkcyan")
```

## Cruces de variables cualitativas con cuantitativas

En primer lugar, consideramos que puede ser interesante comparar las distintas medidas de los pingüinos entre especies. Para esto, primero comparamos individualmente cada variable

### Comparación de las variables cuantitativas según la especie una a una

Para realizar esta comparación, utilizaremos una gráfica de violín para cada una de las variables cualitativas.

:::{layout-ncol=2}
```{r, echo=FALSE}

ggplot(penguins, aes(x = species, y = bill_length_mm, fill = species)) +
  geom_violin() +
  geom_boxplot(width=0.2, fill="lightgray") +
  labs(x = "Especie de Pingüino", y = "Longitud del Pico (mm)",
       title = "Longitud del pico por Especie de pingüino") +
  scale_fill_brewer(palette = "Dark2") +
  guides(fill=guide_legend(title="Especie"))
```

```{r, echo=FALSE}
ggplot(penguins, aes(x = species, y = bill_depth_mm, fill = species)) +
  geom_violin() +
  geom_boxplot(width=0.2, fill="lightgray") +
  labs(x = "Especie de Pingüino", y = "Profundidad del Pico (mm)",
       title = "Profundidad del pico por Especie de pingüino") +
  scale_fill_brewer(palette = "Dark2")+
  guides(fill=guide_legend(title="Especie"))
```

```{r, echo=FALSE}
ggplot(penguins, aes(x = species, y = flipper_length_mm, fill = species)) +
  geom_violin() +
  geom_boxplot(width=0.2, fill="lightgray") +
  labs(x = "Especie de Pingüino", y = "Longitud de la aleta (mm)",
       title = "Longitud de la aleta por Especie de pingüino") +
  scale_fill_brewer(palette = "Dark2")+
  guides(fill=guide_legend(title="Especie"))
```

```{r, echo=FALSE}
ggplot(penguins, aes(x = species, y = body_mass_g, fill = species)) +
  geom_violin() +
  geom_boxplot(width=0.2, fill="lightgray") +
  labs(x = "Especie de Pingüino", y = "Peso (g)",
       title = "Peso por Especie de pingüino") +
  scale_fill_brewer(palette = "Dark2")+
  guides(fill=guide_legend(title="Especie"))
```
:::

En estos gráficos observamos un patrón común: Para cada medida, dos especies de pingüino suelen tener una distribución parecida, y la tercera es visiblemente distinta. Concretamente:

- Los pingüinos Adelie son, con diferencia, los que tienen el pico más corto.
- Los Gentoo tienen, notablemente, el pico más fino, la aleta más larga y el mayor peso.

Una vez visualizadas individualmente, puede ser interesante intentar, por un lado, cruzar las medidas entre ellas y, por el otro, relacionar esto con la especie.

### Comparación de las variables cuantitativas entre ellas y por especie

Un gráfico de dispersión separado por colores nos permite cumplir ambos objetivos de esta sección al mismo tiempo.

Una vez visualizadas individualmente, puede ser interesante intentar, por un lado, cruzar las medidas entre ellas y, por el otro, relacionar esto con la especie. Un gráfico de dispersión separado por colores nos permite cumplir ambos objetivos al mismo tiempo.

```{r}
ggplot(penguins, aes(x = bill_length_mm, y = bill_depth_mm, color = species)) +
  geom_point() + 
  geom_smooth(method = "lm", se = FALSE) +
  labs(x = "Longitud del Pico (mm)", y = "Longitud de la Aleta (mm)",
       title = "Longitud del Pico vs. Longitud de la Aleta por Especie de Pingüino") +
  scale_color_manual(values=species_colors)
```


Vemos que los datos están bastante agrupados en el sentido que, dado una longitud y 

### Distribución de pingüinos según la isla

Veamos en qué islas habitan principalmente las tres especies:

```{r}
ggplot(penguins, aes(fill=island, x=species)) +
  geom_bar() +
  labs(x = "Especie de Pingüino", y = "Frecuencia",
       title = "Distribución de la población por isla y especie")
```

Tenemos que la especie Gentoo se encuentra únicamente en la isla Biscoe y Chinstrap está solo en Dream. Por otra parte, Adelie se puede encontrar en las tres islas y, como ya sabíamos, es la que tiene una mayor población total de pingüinos.

Se puede observar que en función de la isla que tratemos, habitan más pingüinos de una especie u otra:

-   En la isla de **Biscoe** habitan todos los pingüinos de la especie Gentoo y también hay algunos de la especie Adelie, pero no hay de la especie Chinstrap.

-   En la isla de **Dream** cohabitan pingüinos de las especies Adelie y Chinstrap, y es la isla en la que habitan todos los pingüinos de esta última especie.

-   Finalmente, en la isla de **Torgersen** solo habitan pingüinos de la especie Adelie.

  

```{r}
p <- ggplot(penguins, aes(x = "", fill = sex)) +
  geom_bar(width = 1) +
  coord_polar(theta = "y") +
  facet_wrap(~species) +
  labs(x = NULL, y = NULL,
       title = " Proporción de Género por Especie de Pingüino") +
  theme_void() +
  scale_fill_brewer(palette = "Set2")

print(p)
```

```{r}
p <- ggplot(penguins, aes(x = bill_length_mm, y = body_mass_g)) +
  geom_point(aes(color = species)) +
  labs(x = "Longitud del Pico (mm)", y = "Masa Corporal (g)",
       title = "Longitud del Pico y Masa Corporal por Especie de Pingüino") +
  scale_color_brewer(palette = "Set2")

print(p)
```

```{r}
p <- ggplot(penguins, aes(x = bill_length_mm, y = bill_depth_mm, color = species)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(x = "Longitud del Pico (mm)", y = "Profundidad del Pico (mm)",
       title = "Dimensiones del Pico por Especie de Pingüino") +
  scale_color_brewer(palette = "Set2")

print(p)
```


```{r}
ggplot(penguins, aes(x = year, y = body_mass_g, fill=year)) +
  geom_violin() +
  labs(x = "Año", y = "Peso Corporal (g)",
       title = " Año vs. Peso Corporal de Pingüinos") +
  scale_fill_brewer(palette = "Set2")
```


```{r}
ggplot(penguins, aes(x = year, y = body_mass_g, fill=year)) +
  geom_violin() +
  labs(x = "Año", y = "Peso Corporal Promedio (g)",
       title = "Peso Corporal Promedio de Pingüinos por Año")

print(p)
```

```{r}
ggplot(penguins, aes(x = species, y = body_mass_g, fill = species)) +
  geom_violin() +
  geom_boxplot(width=0.2, fill="lightgray") +
  labs(x = "Especie de Pingüino", y = "Peso (g)",
       title = "Peso por Especie de Pingüino") +
  scale_fill_brewer(palette = "Dark2")
```

```{r}
library(ggplot2)

p <- ggplot(penguins, aes(x = interaction(species, island), y = bill_length_mm)) +
  geom_bar(stat = "summary", fun = "mean", fill = "skyblue", position = "dodge") +
  labs(x = "Especie e Isla", y = "Longitud del Pico Promedio (mm)",
       title = "Longitud del Pico Promedio por Combinación de Especie e Isla") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

print(p)
```

```{r}
#Para poder la foto:
#descarga la foto y pollo en el directori del cartografia
# instruccion:  ![Descripcion que quieras]{ruta}
```

